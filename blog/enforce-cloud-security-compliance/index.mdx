---
date: 2023-06-06
authors: [matthias]
tags: [security, aws, resoto]
---

# Enforce Cloud Security Compliance with Resoto

In our rapidly evolving digital landscape, cybersecurity has become a non-negotiable aspect of doing business. Now more than ever, organizations are recognizing the criticality of implementing stringent security compliance in their cloud infrastructure. A security baseline, as we discussed in our [previous blog post](../cloud-resource-security-benchmarks/index.mdx), forms the foundation of this effort.

But the key challenge lies in its effective implementation. In this blog post, we will delve into the intricacies of enforcing a security baseline!

<!--truncate-->

## Define a Security Baseline

The first step in enforcing security compliance is to define a security baseline - a set of rules that all cloud resources must adhere to. The concept and rationale of security compliance and how to build a baseline has been introduced in my [previous blog post](../cloud-resource-security-benchmarks/index.mdx).

## Challenges of Enforcing Security Compliance

Ensuring security compliance for cloud infrastructure is not a trivial task due to the shared responsibility of different personas that are able to create, update or delete cloud resources. There is just no single gatekeeper, that can track and enforce security compliance for all cloud resources.

Let's revisit the most urgent challenges:

1. **Lack of security knowledge**: Developers and SREs may not have comprehensive knowledge of security best practices and the specific requirements for securing cloud infrastructure. This can lead to the unintentional introduction of security vulnerabilities or misconfigurations.

2. **Time constraints**: Developers and SREs are often focused on meeting project deadlines and delivering functionality, which can result in security considerations being overlooked or deprioritized. The pressure to deliver quickly may lead to shortcuts or the bypassing of security controls.

3. **DevOps culture**: The DevOps culture emphasizes rapid development and deployment, blurring the traditional boundaries between development and operations. While this culture promotes agility, collaboration, and efficiency, it can sometimes overlook security measures or create conflicts between security and development priorities.

4. **Lack of communication and collaboration**: In some cases, there may be a communication gap between security teams and developers/SREs. Security requirements and guidelines may not be clearly communicated, resulting in misunderstandings or inconsistent implementation of security controls.

While these challenges pose significant hurdles, there are actionable steps that organizations can take to mitigate their impacts. The common thread that binds these issues is the human factor. To effectively address these challenges, organizations must take a comprehensive, multi-pronged approach.

We start with **integrating security in the development workflows**. This could involve introducing automated security checks and controls into the continuous integration/continuous deployment (CI/CD) pipelines. Automated security testing, vulnerability scanning, and code analysis can form part of a defensive layer, helping to identify and mitigate security issues early in the development process. However, this is not enough.

Organizations also need to invest in **security training and awareness** programs for developers and SREs. These programs aim to enhance their understanding of security best practices and underline the importance of security compliance in cloud infrastructure. By empowering developers and SREs with knowledge, they are less likely to unintentionally introduce vulnerabilities or misconfigurations.

**Automation and tooling** can be leveraged to simplify and streamline security compliance processes. Tools for configuration management, infrastructure as code (IaC), and security policy enforcement can automate repetitive or complex tasks, thereby reducing the potential for human error while freeing up developers' time to focus on what they do best – delivering functionality.

In essence, enforcing security compliance is not a task for a single team or tool but requires a concerted effort across the organization. By integrating security into development workflows, **investing in education**, **harnessing the power of automation and tooling**, and **promoting a culture of collaboration**, organizations can navigate these challenges and bolster their cloud security posture.

## Check Security Compliance

As we have seen in the previous blog post, Resoto allows you to define a security baseline and check your cloud resources against this baseline. ResotoUI has a gorgeous UI that allows to easily navigate a security benchmark result, see affected cloud resources and get guidance on how to remediate the issue. Once all of your security relevant cloud resources are compliant with your security baseline, you have a solid foundation for your cloud security.

The issue starts with the next cloud resource that is created, updated or deleted. How can you ensure that **any new or updated cloud resource is compliant with your security baseline?**

### Create a report on the command line

Resoto not only has a gorgeous UI, but also a powerful CLI that allows you to perform the same security checks as in the UI.

Let's see how this looks like. Assume we want to check all our AWS accounts for compliance with the [CIS AWS Foundations Benchmark](https://www.cisecurity.org/benchmark/amazon_web_services/) we can issue the following command:

```bash
> report benchmark run aws_cis_1_5
```

This will look for all AWS accounts that have been collected and render a nice report for every account in the terminal that looks like this. ![Report Run Result](img/report-run-result.png) The `report` command can be customized by command line options - see `help report` for more details.

If you want to get the report in raw Markdown format you can simply pipe the output of the `report` command to the `write` command:

```bash
> report benchmark run aws_cis_1_5 | write report.md
```

This would write the report to the file `report.md` in the defined [download directory of ResotoShell](/docs/reference/components/shell#options) and is useful in cases, where you want to share or post process the result in a different way.

### Send the result of a report to Discord, Slack, {your favorite messaging service here}

We can not only write the result of a report to a file, we could also take the result and send a message to a [Slack](/docs/how-to-guides/alerting/send-slack-notifications) or [Discord](/docs/how-to-guides/alerting/send-discord-notifications) channel. Too make the message as precise and meaningful as possible, we define the account explicitly and only send the message if there are any issues:

```bash
> report benchmark run aws_cis_1_5
  --accounts 7524xxxx
  --only-failing
  --only-check-results |
  discord
  --title "Security Benchmark Issues!\nAccount 7524xxxx does not adhere to AWS CIS 1.5"
  --key .name --value .number_of_resources_failing
  --webhook https://discord.com/api/webhooks/123/234
```

In case the report command does not find any issues in the defined account, no message will be sent. If there are issues, the message will look similar to this one: ![Discord Message](img/discord-message.jpg)

### Create an alert in PagerDuty or AlertManager

Resoto does not only interface with well-known chat applications like Slack or Discord, but also with [PagerDuty](/docs/how-to-guides/alerting/create-pagerduty-alerts) or [AlertManager](/docs/how-to-guides/alerting/send-prometheus-alertmanager-alerts). Let's assume you have a PagerDuty account and setup an integration, you can create a PagerDuty alert like this:

```bash
> report benchmark run aws_cis_1_5
  --accounts 75246xxxx
  --only-failing
  --only-check-results |
  pagerduty
  --summary "Security Benchmark Issues! Account 7524xxxx does not adhere to AWS CIS 1.5"
  --routing-key <your-pagerduty-routing-key>
  --dedup-key AWS_CIS_75246xxxx
  --resource_id .reported.name
  --group_resources false
  --resource_properties {failing_resources: .reported.number_of_resources_failing}
```

Note: the `routing-key` is the integration key of your PagerDuty integration. The `dedup-key` is used to group alerts together.

Once the report command finds issues in the defined account, a PagerDuty alert will be created that looks like this: ![PagerDuty Alert](img/pagerduty-alert.png)

## Enforce Security Compliance

In the preceding sections, we ventured through:

- The nuances of a security baseline and its formulation
- Evaluating cloud resources in the light of this baseline
- The process of notifications in the event of security baseline violations

Now, our mission is to weave these threads together into a seamless, automated process. Our goal is to ensure every cloud resource—whether created, updated, or deleted—aligns with our security baseline. To accomplish this, we establish a job that triggers the report command in response to a resource changed event. This job, upon detecting any issues, will dispatch a message to a designated chat application or generate an alert via PagerDuty or AlertManager.

![Create Job](img/create-job.jpg)

Resoto ceaselessly scans your infrastructure, covering all integrated cloud providers, accounts, and regions. After collecting the most recent data, Resoto propels the job we have set up. The report command measures the current state of your infrastructure against the pre-established security baseline. Should it stumble upon a security violation, it swiftly communicates this through the chosen alert system - a chat application or an alert in PagerDuty or AlertManager.

By automating the security baseline assessment and the consequential alert generation, we've turned the tedious and complex aspects of cloud security into a straightforward process. This immediate alert system ensures rapid detection of security issues following any changes in the infrastructure.

Our attention can now pivot to the crux of the matter - remediation. With every detected issue, Resoto not only highlights the affected cloud resource within the user interface but also furnishes guidance on resolution paths.

![ResotoUI](img/benchmark-check-details.png)

## Conclusion

In this blog post, we've delved into the intricacies of enforcing security compliance in cloud resources, with an emphasis on the role of a security baseline and its automated enforcement through Resoto. We examined the unique challenges that organizations face in this context and discussed potential solutions, highlighting the need for education, integration, automation, and collaboration.

We then explored how Resoto can tie these elements together, offering a constant surveillance of your cloud infrastructure and an automated alerting system for any security baseline violations.

Finally, we showcased how Resoto facilitates swift remediation by pointing directly to the affected resource and providing guidance for issue resolution. Through the integration of these measures, the task of securing cloud resources becomes less daunting and more strategic, transforming security compliance from a challenge into a significant asset for your organization.
